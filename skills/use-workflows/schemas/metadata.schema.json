{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["workflow", "feature", "phases", "totals"],
  "properties": {
    "workflow": {
      "type": "object",
      "required": ["name", "execution_mode", "started_at", "completed_at", "duration_seconds"],
      "properties": {
        "name": {
          "type": "string"
        },
        "execution_mode": {
          "type": "string",
          "enum": ["strict", "loose", "adaptive"]
        },
        "started_at": {
          "type": "string",
          "format": "date-time"
        },
        "completed_at": {
          "type": "string",
          "format": "date-time"
        },
        "duration_seconds": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "feature": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string"
        },
        "flags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "phases": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "status"],
        "properties": {
          "id": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": ["completed", "skipped", "aborted"]
          },
          "iterations": {
            "type": "integer",
            "minimum": 1
          },
          "subagents_spawned": {
            "type": "integer",
            "minimum": 0
          },
          "deliverables": {
            "type": "integer",
            "minimum": 0
          }
        }
      }
    },
    "totals": {
      "type": "object",
      "required": ["phases_completed", "phases_skipped", "subagents_spawned", "deliverables_created", "checkpoints_hit"],
      "properties": {
        "phases_completed": {
          "type": "integer",
          "minimum": 0
        },
        "phases_skipped": {
          "type": "integer",
          "minimum": 0
        },
        "subagents_spawned": {
          "type": "integer",
          "minimum": 0
        },
        "deliverables_created": {
          "type": "integer",
          "minimum": 0
        },
        "checkpoints_hit": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "final_plan": {
      "type": "string"
    }
  }
}
